<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.80.0" />
    <meta name="description" content="">


    <link rel="icon" href="/images/favicon.png" type="image/png">

    <title>Healthcheck :: Cabourotte verifies if your infrastructure is healthy</title>

    
    <link href="/css/nucleus.css?1616181441" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1616181441" rel="stylesheet">
    <link href="/css/hybrid.css?1616181441" rel="stylesheet">
    <link href="/css/featherlight.min.css?1616181441" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1616181441" rel="stylesheet">
    <link href="/css/auto-complete.css?1616181441" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1616181441" rel="stylesheet">
    <link href="/css/theme.css?1616181441" rel="stylesheet">
    <link href="/css/hugo-theme.css?1616181441" rel="stylesheet">
    
    <link href="/css/theme-blue.css?1616181441" rel="stylesheet">
    
    

    <script src="/js/jquery-3.3.1.min.js?1616181441"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
        :not(pre) > code + span.copy-to-clipboard {
            display: none;
        }
      
    </style>
    
  </head>
  <body class="" data-url="/api/healthcheck/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="https://cabourotte.mcorbin.fr">
  <h2>Cabourotte</p>
</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1616181441"></script>
<script type="text/javascript" src="/js/auto-complete.js?1616181441"></script>
<script type="text/javascript">
    
        var baseurl = "https:\/\/cabourotte.mcorbin.fr";
    
</script>
<script type="text/javascript" src="/js/search.js?1616181441"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/installation/" title="Installation" class="dd-item 
        
        
        
        ">
      <a href="/installation/">
          Installation
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/installation/get-cabourotte/" title="Get or build Cabourotte" class="dd-item 
        
        
        
        ">
      <a href="/installation/get-cabourotte/">
          Get or build Cabourotte
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/installation/configuration/" title="Configuration" class="dd-item 
        
        
        
        ">
      <a href="/installation/configuration/">
          Configuration
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/installation/launch-it/" title="Launch it" class="dd-item 
        
        
        
        ">
      <a href="/installation/launch-it/">
          Launch it
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/installation/monitoring/" title="Monitoring" class="dd-item 
        
        
        
        ">
      <a href="/installation/monitoring/">
          Monitoring
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/installation/frontend/" title="Frontend" class="dd-item 
        
        
        
        ">
      <a href="/installation/frontend/">
          Frontend
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/api/" title="API" class="dd-item 
        parent
        
        
        ">
      <a href="/api/">
          API
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/api/healthcheck/" title="Healthcheck" class="dd-item 
        parent
        active
        
        ">
      <a href="/api/healthcheck/">
          Healthcheck
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/api/result/" title="Result" class="dd-item 
        
        
        
        ">
      <a href="/api/result/">
          Result
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/exporters/" title="Exporters" class="dd-item 
        
        
        
        ">
      <a href="/exporters/">
          Exporters
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/exporters/http/" title="HTTP" class="dd-item 
        
        
        
        ">
      <a href="/exporters/http/">
          HTTP
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/community/" title="Community" class="dd-item 
        
        
        
        ">
      <a href="/community/">
          Community
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/community/how-to-contribute/" title="How to contribute" class="dd-item 
        
        
        
        ">
      <a href="/community/how-to-contribute/">
          How to contribute
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/community/support/" title="Support" class="dd-item 
        
        
        
        ">
      <a href="/community/support/">
          Support
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
         
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li> 
                  <a class="padding" href="https://github.com/mcorbin/cabourotte"><i class='fab fa-github'></i> Github repo</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://github.com/matcornic/hugo-theme-learn/"><i class='fas fa-bookmark'></i> Site theme</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="footer">
      <b><p>Powered by <a href="https://mcorbin.fr">mcorbin</a></p></b>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/'></a> > <a href='/api/'>API</a> > Healthcheck
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li><a href="#creating-healthchecks">Creating healthchecks</a>
      <ul>
        <li><a href="#create-a-http-healthcheck">Create a HTTP healthcheck</a></li>
        <li><a href="#create-a-tcp-healthcheck">Create a TCP healthcheck</a></li>
        <li><a href="#create-a-dns-healthcheck">Create a DNS Healthcheck</a></li>
        <li><a href="#create-a-tls-healthcheck">Create a TLS Healthcheck</a></li>
        <li><a href="#create-several-healthchecks-bulk">Create several healthchecks (bulk)</a></li>
        <li><a href="#create-a-one-off-healthcheck">Create a One-Off healthcheck</a></li>
        <li><a href="#delete-a-healthcheck">Delete a healthcheck</a></li>
        <li><a href="#list-healthchecks">List healthchecks</a></li>
        <li><a href="#get-a-healthcheck">Get a healthcheck</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Healthcheck
            </h1>
          

        



	<h2 id="creating-healthchecks">Creating healthchecks</h2>
<p>Cabourotte provides several endpoints to create various kind of healthchecks. The payload is formatted as json, and should be a valid healthcheck definition.</p>
<p>The availables options for healthchecks are exactly the same than the one described in the <a href="/installation/configuration/">configuration</a> section.</p>
<p>If the parameter <code>one-off</code> is set to <code>true</code> in the payload, the healthcheck will be instantly executed and the result will be returned in the HTTP response (an example is available on this page). In that case, the healthcheck will <strong>not</strong> be periodically executed.</p>
<p>A bulk endpoint allows you to configure all healthchecks in one API call.</p>
<h3 id="create-a-http-healthcheck">Create a HTTP healthcheck</h3>
<ul>
<li><strong>POST</strong> /healthcheck/http</li>
</ul>
<hr>
<pre><code>curl -H &quot;Content-Type: application/json&quot; 127.0.0.1:9013/healthcheck/http -d '{&quot;name&quot;:&quot;mcorbin-http-check&quot;,&quot;description&quot;:&quot;http healthcheck example&quot;,&quot;target&quot;:&quot;mcorbin.fr&quot;,&quot;interval&quot;:&quot;5s&quot;,&quot;timeout&quot;: &quot;3s&quot;,&quot;port&quot;:443,&quot;protocol&quot;:&quot;https&quot;,&quot;valid-status&quot;:[200]}'

{&quot;message&quot;:&quot;Healthcheck successfully added&quot;}
</code></pre><h3 id="create-a-tcp-healthcheck">Create a TCP healthcheck</h3>
<ul>
<li><strong>POST</strong> /healthcheck/tcp</li>
</ul>
<hr>
<pre><code>curl -H &quot;Content-Type: application/json&quot; 127.0.0.1:9013/healthcheck/tcp -d '{&quot;name&quot;:&quot;mcorbin-tcp-check&quot;,&quot;description&quot;:&quot;http healthcheck example&quot;,&quot;target&quot;:&quot;mcorbin.fr&quot;,&quot;interval&quot;:&quot;5s&quot;,&quot;timeout&quot;: &quot;3s&quot;,&quot;port&quot;:443}'

{&quot;message&quot;:&quot;Healthcheck successfully added&quot;}

</code></pre><h3 id="create-a-dns-healthcheck">Create a DNS Healthcheck</h3>
<ul>
<li><strong>POST</strong> /healthcheck/dns</li>
</ul>
<hr>
<pre><code>curl -H &quot;Content-Type: application/json&quot; 127.0.0.1:9013/healthcheck/dns -d '{&quot;name&quot;:&quot;mcorbin-dns-check&quot;,&quot;description&quot;:&quot;dns healthcheck example&quot;,&quot;domain&quot;:&quot;mcorbin.fr&quot;,&quot;interval&quot;:&quot;5s&quot;}'

{&quot;message&quot;:&quot;Healthcheck successfully added&quot;}
</code></pre><h3 id="create-a-tls-healthcheck">Create a TLS Healthcheck</h3>
<ul>
<li><strong>POST</strong> /healthcheck/tls</li>
</ul>
<hr>
<pre><code>curl -H &quot;Content-Type: application/json&quot; 127.0.0.1:9013/healthcheck/tls -d '{&quot;name&quot;:&quot;mcorbin-tls-check&quot;,&quot;description&quot;:&quot;tls healthcheck example&quot;,&quot;target&quot;:&quot;mcorbin.fr&quot;,&quot;interval&quot;:&quot;5s&quot;,&quot;timeout&quot;: &quot;3s&quot;,&quot;port&quot;:443, &quot;expiration-delay&quot;: &quot;48h&quot;}'

{&quot;message&quot;:&quot;Healthcheck successfully added&quot;}
</code></pre><h3 id="create-several-healthchecks-bulk">Create several healthchecks (bulk)</h3>
<p>This endpoint can be used to create several healthchecks at once. When this endpoint is used, Cabourotte will:</p>
<p>Add (or update if it already exists) all healthchecks passed as parameter</p>
<p>Stop all healthchecks not managed by the configuration file and not passed as parameter. This point is important, you cannot use this API call to create or update only a subset of your healthchecks.</p>
<ul>
<li><strong>POST</strong> /healthcheck/bulk</li>
</ul>
<hr>
<pre><code>curl -H &quot;Content-Type: application/json&quot; 127.0.0.1:9013/healthcheck/bulk -d '
{
  &quot;tls-checks&quot;: [
    {
      &quot;name&quot;: &quot;mcorbin-tls-check&quot;,
      &quot;description&quot;: &quot;tls healthcheck example&quot;,
      &quot;target&quot;: &quot;mcorbin.fr&quot;,
      &quot;interval&quot;: &quot;5s&quot;,
      &quot;timeout&quot;: &quot;3s&quot;,
      &quot;port&quot;: 443,
      &quot;expiration-delay&quot;: &quot;48h&quot;
    }
  ],
  &quot;tcp-checks&quot;: [
    &quot;...&quot;
  ],
  &quot;http-checks&quot;: [
    &quot;...&quot;
  ],
  &quot;dns-checks&quot;: [
    &quot;...&quot;
  ]
}
'

{&quot;message&quot;:&quot;Healthchecks successfully added&quot;}
</code></pre><h3 id="create-a-one-off-healthcheck">Create a One-Off healthcheck</h3>
<p>As explained before, the <code>one-off</code> parameter can be set to <code>true</code> in the payload to create a <code>one-off</code> healthcheck which will be instantly executed.</p>
<hr>
<p><strong>Success example</strong>:</p>
<pre><code>curl -H &quot;Content-Type: application/json&quot; 127.0.0.1:9013/healthcheck/dns -d '{&quot;name&quot;:&quot;mcorbin-dns-check&quot;,&quot;description&quot;:&quot;dns healthcheck example&quot;,&quot;domain&quot;:&quot;mcorbin.fr&quot;,&quot;interval&quot;:&quot;5s&quot;,&quot;one-off&quot;: true}'

{&quot;message&quot;:&quot;One-off healthcheck mcorbin-dns-check successfully executed&quot;}
</code></pre><p><strong>Error example</strong>:</p>
<pre><code>curl -H &quot;Content-Type: application/json&quot; 127.0.0.1:9013/healthcheck/dns -d '{&quot;name&quot;:&quot;mcorbin-dns-check&quot;,&quot;description&quot;:&quot;dns healthcheck example&quot;,&quot;domain&quot;:&quot;doesnotexist.mcorbin.fr&quot;,&quot;interval&quot;:&quot;5s&quot;,&quot;one-off&quot;: true}'

{&quot;message&quot;:&quot;Execution of one off healthcheck mcorbin-dns-check failed: Fail to lookup IP for domain: lookup doesnotexist.mcorbin.fr on 192.168.43.1:53: no such host&quot;}
</code></pre><h3 id="delete-a-healthcheck">Delete a healthcheck</h3>
<ul>
<li><strong>DELETE</strong> /healthcheck/<!-- raw HTML omitted --></li>
</ul>
<hr>
<pre><code>curl -X DELETE 127.0.0.1:9013/healthcheck/mcorbin-dns-check

{&quot;message&quot;:&quot;Successfully deleted healthcheck mcorbin-dns-check&quot;}
</code></pre><h3 id="list-healthchecks">List healthchecks</h3>
<ul>
<li><strong>GET</strong> /healthcheck</li>
</ul>
<hr>
<pre><code>curl 127.0.0.1:9013/healthcheck

[
  {
    &quot;name&quot;: &quot;mcorbin-dns-check&quot;,
    &quot;description&quot;: &quot;dns healthcheck example&quot;,
    &quot;domain&quot;: &quot;mcorbin.fr&quot;,
    &quot;interval&quot;: &quot;5s&quot;,
    &quot;one-off&quot;: false
  },
  {
    &quot;name&quot;: &quot;mcorbin-http-check&quot;,
    &quot;valid-status&quot;: [
      200
    ],
    &quot;description&quot;: &quot;http healthcheck example&quot;,
    &quot;target&quot;: &quot;mcorbin.fr&quot;,
    &quot;port&quot;: 443,
    &quot;redirect&quot;: false,
    &quot;protocol&quot;: &quot;https&quot;,
    &quot;timeout&quot;: &quot;3s&quot;,
    &quot;interval&quot;: &quot;5s&quot;,
    &quot;one-off&quot;: false
  }
]
</code></pre><h3 id="get-a-healthcheck">Get a healthcheck</h3>
<ul>
<li><strong>GET</strong> /healthcheck/<!-- raw HTML omitted --></li>
</ul>
<hr>
<pre><code>curl 127.0.0.1:9013/healthcheck/mcorbin-dns-check

{
  &quot;name&quot;: &quot;mcorbin-dns-check&quot;,
  &quot;description&quot;: &quot;dns healthcheck example&quot;,
  &quot;domain&quot;: &quot;mcorbin.fr&quot;,
  &quot;interval&quot;: &quot;5s&quot;,
  &quot;one-off&quot;: false
}
</code></pre>




<footer class=" footline" >
	
</footer>

        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
        
        


	 
	 
		
			<a class="nav nav-prev" href="/api/" title="API"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/api/result/" title="Result" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1616181441"></script>
    <script src="/js/perfect-scrollbar.min.js?1616181441"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1616181441"></script>
    <script src="/js/jquery.sticky.js?1616181441"></script>
    <script src="/js/featherlight.min.js?1616181441"></script>
    <script src="/js/highlight.pack.js?1616181441"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1616181441"></script>
    <script src="/js/learn.js?1616181441"></script>
    <script src="/js/hugo-learn.js?1616181441"></script>

    <link href="/mermaid/mermaid.css?1616181441" rel="stylesheet" />
    <script src="/mermaid/mermaid.js?1616181441"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    

  </body>
</html>
